<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>android sqlite database | WenYue</title>
  <meta name="author" content="Wenyue">
  
  <meta name="description" content="java web android">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="android sqlite database"/>
  <meta property="og:site_name" content="WenYue"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="WenYue" type="application/atom+xml">
  <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
  <script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-368771XX-X']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

</head>

<body>
  <header id="header" class='normal_mode'>
    <nav id="main-nav">
  <ul class='container'>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
      <li><a href="/about">About</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
  </header>
  <div id="content" class="container">
    <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
      <time datetime="2014-10-22T14:54:30.000Z"><a href="/2014/10/22/android-sqlite-database/">周三, 10月 22 2014, 10:54:30 晚上</a></time>

  
    <h1 class="title">android sqlite database</h1>
  



  
  <div class="tags">
  	<i class="fa fa-tag"></i>
    <a href="/tags/android/">android</a>
  </div>

<div class="clear"></div>
      
    </header>
    <div class="entry">
      
        <p>好吧，现在来看一下在android里面使用sqlite数据库的一些基本操作吧。</p>
<pre><code>对于大多数<span class="keyword">app</span>而言对数据库的要求很简单，无非CURD，仅此而已。而我个人比较喜欢将所要使用的相应数据    表封装成javabean再进行操作，这样会显得逻辑比较清晰。
</code></pre><p>首先，我们写一个Entity：</p>
<pre><code><span class="keyword">package</span> wenyue.justdoit.entity;

<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">todoData</span> </span>{
<span class="keyword">private</span> String todotadkname;
<span class="keyword">private</span> <span class="keyword">int</span> id;

<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>{
    <span class="keyword">return</span> id;
}

<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>{
    <span class="keyword">this</span>.id = id;
}

<span class="function"><span class="keyword">public</span> <span class="title">todoData</span><span class="params">()</span> </span>{

}

<span class="function"><span class="keyword">public</span> String <span class="title">getTodotadkname</span><span class="params">()</span> </span>{
    <span class="keyword">return</span> todotadkname;
}

<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTodotadkname</span><span class="params">(String todotadkname)</span> </span>{
    <span class="keyword">this</span>.todotadkname = todotadkname;
}

}
</code></pre><p>在这之后呢，我们需要一个继承了SQLiteOpenHelper的工具类。在这之后，我们只需要在进行对entity进行数据库操作的时候对其进行实例化即可。</p>
<pre><code>SQLiteOpenHelper需要重写onCreate，onUpgrade方法。android已经对sqlite数据库的操作进行了封装，所以若是你想要更深入了解数据库操作，可以参考JDBC的使用。OnCreate再首次创建数据库时调用。而我们要进行数据库操作时可用SQLiteDatabase db = this.<span class="function"><span class="title">getWritableDatabase</span><span class="params">()</span></span>。文档说该方法使db获得了写数据库的权限，感觉其实就是拿到了相应数据库的廉洁实体。
</code></pre><p>那么下面就直接贴出继承了SQLiteOpenHelper的工具类代码吧，毕竟都是些很简单的东西，看方法名就能知道是干什么的了。</p>
<pre><code><span class="keyword">package</span> wenyue.justdoit.util;

<span class="keyword">import</span> java.util.ArrayList;
<span class="keyword">import</span> java.util.List;

<span class="keyword">import</span> wenyue.justdoit.entity.todoData;
<span class="keyword">import</span> android.content.ContentValues;
<span class="keyword">import</span> android.content.Context;
<span class="keyword">import</span> android.database.Cursor;
<span class="keyword">import</span> android.database.sqlite.SQLiteDatabase;
<span class="keyword">import</span> android.database.sqlite.SQLiteOpenHelper;
<span class="keyword">import</span> android.util.Log;

<span class="keyword">public</span> class dbHelper extends SQLiteOpenHelper {

<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="built_in">int</span> DATABASE_VERSION = <span class="number">1</span>;

<span class="comment">// Database Name</span>
<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> DATABASE_NAME = <span class="string">"todolistManager"</span>;

<span class="comment">// tasks table name</span>
<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> TABLE_TASKS = <span class="string">"todolist"</span>;

<span class="comment">// tasks Table Columns names</span>
<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> KEY_ID = <span class="string">"id"</span>;
<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> KEY_TASKNAME = <span class="string">"todotadkname"</span>;

<span class="keyword">public</span> dbHelper(Context context) {
    <span class="keyword">super</span>(context, DATABASE_NAME, <span class="keyword">null</span>, DATABASE_VERSION);
    <span class="comment">// TODO Auto-generated constructor stub</span>
}

@Override
<span class="keyword">public</span> <span class="keyword">void</span> onCreate(SQLiteDatabase db) {
    <span class="keyword">String</span> sql = <span class="string">"CREATE TABLE IF NOT EXISTS "</span> + TABLE_TASKS + <span class="string">" ( "</span>
            + KEY_ID + <span class="string">" INTEGER PRIMARY KEY AUTOINCREMENT, "</span>
            + KEY_TASKNAME + <span class="string">" TEXT"</span> + <span class="string">")"</span>;
    db.execSQL(sql);
    <span class="comment">// db.close();</span>

}

@Override
<span class="keyword">public</span> <span class="keyword">void</span> onUpgrade(SQLiteDatabase db, <span class="built_in">int</span> oldVersion, <span class="built_in">int</span> newVersion) {
    db.execSQL(<span class="string">"DROP TABLE IF EXISTS "</span> + TABLE_TASKS);
    <span class="comment">// Create tables again</span>
    onCreate(db);

}

<span class="keyword">public</span> <span class="keyword">void</span> <span class="built_in">save</span>(todoData testdata) {
    SQLiteDatabase db = <span class="keyword">this</span>.getWritableDatabase();

    ContentValues values = <span class="keyword">new</span> ContentValues();
    values.put(KEY_TASKNAME, testdata.getTodotadkname());
    db.insert(TABLE_TASKS, <span class="keyword">null</span>, values);
    db.close();
}

<span class="keyword">public</span> List&lt;todoData&gt; getAllTasks() {
    List&lt;todoData&gt; taskList = <span class="keyword">new</span> ArrayList&lt;todoData&gt;();
    <span class="comment">// Select All Query</span>
    <span class="keyword">String</span> selectQuery = <span class="string">"SELECT  * FROM "</span> + TABLE_TASKS;

    SQLiteDatabase db = <span class="keyword">this</span>.getWritableDatabase();
    Cursor <span class="built_in">cursor</span> = db.rawQuery(selectQuery, <span class="keyword">null</span>);

    <span class="comment">// looping through all rows and adding to list</span>
    <span class="keyword">if</span> (<span class="built_in">cursor</span>.moveToFirst()) {
        do {
            todoData task = <span class="keyword">new</span> todoData();
            task.setId(<span class="built_in">cursor</span>.getInt(<span class="number">0</span>));
            task.setTodotadkname(<span class="built_in">cursor</span>.getString(<span class="number">1</span>));
            <span class="comment">// Adding contact to list</span>
            taskList.<span class="built_in">add</span>(task);
        } <span class="keyword">while</span> (<span class="built_in">cursor</span>.moveToNext());
    }
    db.close();
    <span class="keyword">return</span> taskList;
}

<span class="keyword">public</span> <span class="built_in">int</span> checkIsExits(<span class="keyword">String</span> s) {
    List&lt;todoData&gt; taskList = <span class="keyword">new</span> ArrayList&lt;todoData&gt;();
    <span class="keyword">String</span> selectQuery = <span class="string">"SELECT * FROM "</span> + TABLE_TASKS + <span class="string">" WHERE "</span>
            + KEY_TASKNAME + <span class="string">" = ?"</span>;

    SQLiteDatabase db = <span class="keyword">this</span>.getWritableDatabase();
    Cursor <span class="built_in">cursor</span> = db.rawQuery(selectQuery, <span class="keyword">new</span> <span class="keyword">String</span>[] { s });
    <span class="keyword">if</span> (<span class="built_in">cursor</span>.moveToFirst()) {
        do {
            todoData task = <span class="keyword">new</span> todoData();
            task.setId(<span class="built_in">cursor</span>.getInt(<span class="number">0</span>));
            task.setTodotadkname(<span class="built_in">cursor</span>.getString(<span class="number">1</span>));
            <span class="comment">// Adding contact to list</span>
            taskList.<span class="built_in">add</span>(task);
        } <span class="keyword">while</span> (<span class="built_in">cursor</span>.moveToNext());
    }
    Log.i(<span class="string">"checkIsExits"</span>, <span class="keyword">String</span>.valueOf(taskList.<span class="built_in">size</span>()));
    db.close();
    <span class="keyword">return</span> taskList.<span class="built_in">size</span>();

}

<span class="keyword">public</span> <span class="built_in">int</span> getTaskID(<span class="keyword">String</span> tsakName) {

    List&lt;todoData&gt; taskList = <span class="keyword">new</span> ArrayList&lt;todoData&gt;();
    <span class="keyword">String</span> selectQuery = <span class="string">"SELECT * FROM "</span> + TABLE_TASKS + <span class="string">" WHERE "</span>
            + KEY_TASKNAME + <span class="string">" = ?"</span>;

    SQLiteDatabase db = <span class="keyword">this</span>.getWritableDatabase();
    Cursor <span class="built_in">cursor</span> = db.rawQuery(selectQuery, <span class="keyword">new</span> <span class="keyword">String</span>[] { tsakName });
    <span class="keyword">if</span> (<span class="built_in">cursor</span>.moveToFirst()) {
        do {
            todoData task = <span class="keyword">new</span> todoData();
            task.setId(<span class="built_in">cursor</span>.getInt(<span class="number">0</span>));
            task.setTodotadkname(<span class="built_in">cursor</span>.getString(<span class="number">1</span>));
            <span class="comment">// Adding contact to list</span>
            taskList.<span class="built_in">add</span>(task);
        } <span class="keyword">while</span> (<span class="built_in">cursor</span>.moveToNext());
    }
    Log.i(<span class="string">"GET_TASK_ID"</span>, <span class="keyword">String</span>.valueOf(taskList.<span class="built_in">get</span>(<span class="number">0</span>).getId()));
    db.close();
    <span class="keyword">return</span> taskList.<span class="built_in">get</span>(<span class="number">0</span>).getId();

}

<span class="keyword">public</span> <span class="keyword">void</span> updateTask(<span class="keyword">String</span> taskName, <span class="built_in">int</span> id) {
    Log.i(<span class="string">"updateTask"</span>, <span class="keyword">String</span>.valueOf(id) + <span class="string">"-------------"</span> + taskName);
    <span class="comment">// updating row</span>
    SQLiteDatabase db = <span class="keyword">this</span>.getWritableDatabase();
    ContentValues values = <span class="keyword">new</span> ContentValues();
    values.put(KEY_TASKNAME, taskName);
    <span class="keyword">String</span>[] args = { <span class="keyword">String</span>.valueOf(id) };

    db.update(TABLE_TASKS, values, KEY_ID + <span class="string">" = ?"</span>, args);
    Log.i(<span class="string">"UPDATESUCCESS"</span>, <span class="keyword">String</span>.valueOf(id));
    db.close();
}

<span class="keyword">public</span> <span class="keyword">void</span> deleteTask(<span class="keyword">String</span> taskname) {
    SQLiteDatabase db = <span class="keyword">this</span>.getWritableDatabase();
    <span class="keyword">String</span>[] args = { <span class="keyword">String</span>.valueOf(taskname) };
    db.delete(TABLE_TASKS, KEY_TASKNAME + <span class="string">"=?"</span>, args);
    db.close();
}

}
</code></pre><p>至于具体的数据处理就不用多说了吧，大家拿到实例后，调用相应的方法即可。好吧，先写这么多了。</p>

      
    </div>
    <footer>
      
          
<!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
  <span class="jiathis_txt">分享到：</span>
  <a class="jiathis_button_weixin">微信</a>
  <a class="jiathis_button_tsina">新浪微博</a>
  <a class="jiathis_button_renren">人人网</a>
  <a class="jiathis_button_qzone">QQ空间</a>
  <a class="jiathis_button_douban">豆瓣</a>
  <a class="jiathis_button_pocket">Pocket</a>
  <a href="http://www.jiathis.com/share?uid=901656" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a>
  <a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" src="http://v3.jiathis.com/code_mini/jia.js?uid=901656" charset="utf-8"></script>
<!-- JiaThis Button END -->

          <div class="clearfix"></div>
          <nav id="pagination">
  
    <a href="/2014/11/17/android-listview-item点击展开/" class="alignleft prev"><i class="fa fa-long-arrow-left"></i>Next</a>
  
  
    <a href="/2014/10/20/android---activity/" class="alignright next">Prev<i class="fa fa-long-arrow-right"></i></a>
  
  <div class="clearfix"></div>
</nav>
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">留言</h1>

  
      <!-- Duoshuo Comment BEGIN -->
<div class="ds-thread" data-thread-key="/2014/10/22/android-sqlite-database/"></div>
<!-- Duoshuo Comment END -->
  
</section>



    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div>
  
  &copy; 2015 Wenyue
  
</div>
Powered by <a href="http://zespia.tw/hexo/" title="Hexo" target="_blank" rel="external">Hexo</a> and <a href="http://pages.github.com/" title="GitHub Pages" target="_blank" rel="external">GitHub Pages</a>

<div class="clearfix"></div></footer>
  
<script src="/js/jquery.imagesloaded.min.js" type="text/javascript"></script>
<script src="/js/gallery.js" type="text/javascript"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js" type="text/javascript"></script>




    <script type="text/javascript">
        (function(){

            $(window).scroll(function(){

                var scrollTop = $(window).scrollTop();
                if ( scrollTop >200 ){
                    $("#main-nav").removeClass('normal_mode').addClass('top_mode');
                } else{
                    $("#main-nav").removeClass('top_mode').addClass('normal_mode');
                }

            });

        })();
    </script>



  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript">
  (function($){
    $('.fancybox').fancybox({
      'titlePosition': 'inside'
    });
  })(jQuery);
  </script>



    
    <script type="text/javascript">
      var duoshuoQuery = {short_name:"wenyue"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.src = 'http://static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0] 
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>



<script type="text/javascript">
  
  $(function(){

    $('.title').hover(
      function() {      
        $(this).stop().animate(
          {'marginLeft': '10px'}, 200
        );   
      }, 
      function() {       
        $(this).stop().animate({'marginLeft': '0px'}, 200);      
      
    });   

  });

</script>


</body>
</html>